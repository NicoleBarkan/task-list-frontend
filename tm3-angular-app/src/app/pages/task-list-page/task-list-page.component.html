<div class="task-list">
  <div class="task-list-header">
    <div class="greeting-text">
      {{ 'TASK_LIST.GREETING' | translate }}, <strong>{{ firstName }} {{ lastName }}</strong>!
    </div>

    <div class="right-controls">
      <div class="logout-button">
        <button mat-stroked-button color="warn" (click)="logout()">
          {{ 'TASK_LIST.LOGOUT' | translate }}
        </button>
      </div>

      <div class="admin-buttons" *ngIf="isAdmin()">
        <button mat-raised-button color="primary" (click)="openCreateTask()">
          {{ 'TASK_LIST.CREATE' | translate }}
        </button>
        <button mat-stroked-button color="accent" routerLink="/users">
          {{ 'TASK_LIST.VIEW_USERS' | translate }}
        </button>
      </div>
    </div>
  </div>

  <div class="task-list-content">
    <ng-container *ngIf="tasks().length > 0; else noTasks">
      @for (task of tasks(); track task.id) {
        <mat-card class="task-card">
          <mat-card-header>
            <div mat-card-avatar class="task-avatar">{{ task.id }}</div>
            <a mat-card-title [routerLink]="['/details', task.id]" class="task-link">
              {{ task.title }}
            </a>
            <mat-card-subtitle>
              <span class="task-meta">{{ task.type | titlecase }} â€¢ {{ task.status | titlecase }}</span>
            </mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <p class="task-description">
              {{ task.description || ('TASK_LIST.NO_DESCRIPTION' | translate) }}
            </p>
            <p class="task-date">
              {{ 'TASK.DETAILS.CREATED' | translate }}: {{ task.createdOn | date: 'dd.MM.yyyy, HH:mm' : '+0600' }}
            </p>
            <p class="task-date" *ngIf="task.updatedOn">
              {{ 'TASK.DETAILS.UPDATED' | translate }}: {{ task.updatedOn | date: 'dd.MM.yyyy, HH:mm' : '+0300' }}
            </p>
          </mat-card-content>

          <mat-card-actions align="end" class="task-actions" *ngIf="isAdmin()">
            <button mat-stroked-button color="accent" [routerLink]="['/edit', task.id]">
              {{ 'TASK_LIST.EDIT' | translate }}
            </button>
            <button mat-stroked-button color="warn" (click)="deleteTask(task.id)">
              {{ 'TASK_LIST.DELETE' | translate }}
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </ng-container>
    
    <ng-template #noTasks>
      <p>{{ 'TASK_LIST.NO_TASKS' | translate }}</p>
    </ng-template>
  </div>
</div>
