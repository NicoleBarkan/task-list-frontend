<div class="task-list">
  <div class="task-list-header">
    <div class="greeting-text">
      Welcome, <strong>{{ firstName }} {{ lastName }}</strong>!
    </div>
    <div class="logout-button">
      <button mat-stroked-button color="warn" (click)="logout()">Logout</button>
    </div>
  </div>

  <div class="header-button" *ngIf="isAdmin()">
    <button mat-raised-button color="primary" (click)="openCreateTask()">Create New Task</button>
    <button mat-stroked-button color="accent" routerLink="/users">View Users</button>
  </div>

  <div class="task-list-content">
    @for (task of tasks$ | async; track task.id) {
      <mat-card class="task-card">
        <mat-card-header>
          <div mat-card-avatar class="task-avatar">{{ task.id }}</div>
          <a mat-card-title [routerLink]="['/details', task.id]" class="task-link">
            {{ task.title }}
          </a>
          <mat-card-subtitle>
            <span class="task-meta">{{ task.type | titlecase }} â€¢ {{ task.status | titlecase }}</span>
          </mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
          <p class="task-description">{{ task.description || 'No description provided.' }}</p>
          <p class="task-date">Created: {{ task.createdOn | date: 'dd.MM.yyyy, HH:mm' : '+0600' }}</p>
          <p class="task-date" *ngIf="task.updatedOn">Updated: {{ task.updatedOn | date: 'dd.MM.yyyy, HH:mm' : '+0300' }}</p>
        </mat-card-content>

        <mat-card-actions align="end" class="task-actions" *ngIf="canEditOrDelete()">
          <button mat-stroked-button color="accent" [routerLink]="['/edit', task.id]">Edit</button>
          <button mat-stroked-button color="warn" (click)="deleteTask(task.id!)">Delete</button>
        </mat-card-actions>
      </mat-card>
    }
  </div>
</div>
